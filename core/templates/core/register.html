{% extends 'core/base.html' %}
{% load static %}
{% block title %}Registro{% endblock %}

{% block content %}
<section class="register-container">
  <div class="register-card">
    <h2 class="register-title">Crea tu cuenta en Sabores</h2>
    <p class="register-subtitle">Completa tus datos para comenzar</p>

    <form method="post" enctype="multipart/form-data" class="register-form">
      {% csrf_token %}
      {{ uform.non_field_errors }}
      {{ pform.non_field_errors }}

      <!-- Selección de Rol -->
      <div class="form-group">
        <label for="id_rol">Rol:</label>
        <select name="rol" id="id_rol" class="form-control">
          <option value="cliente">Cliente</option>
          <option value="proveedor">Proveedor</option>
        </select>
      </div>

      <!-- Datos del Usuario -->
      <div class="form-section">
        <h3>Datos de acceso</h3>
        {{ uform.as_p }}
      </div>

      <!-- Datos del Proveedor -->
      <div id="proveedor-fields" class="form-section hidden">
        <h3>Datos del proveedor</h3>
        {{ pform.as_p }}
      </div>

      <button type="submit" class="btn btn-primary w-100">Registrar cuenta</button>
    </form>

    <p class="login-link">
      ¿Ya tienes cuenta?
      <a href="{% url 'core:login' %}">Inicia sesión aquí</a>
    </p>
  </div>
</section>

<script>
  // Mostrar/ocultar los campos del proveedor según el rol seleccionado
  const rolSelect = document.getElementById('id_rol');
  const proveedorFields = document.getElementById('proveedor-fields');

  function toggleProveedorFields() {
    if (rolSelect.value === 'proveedor') {
      proveedorFields.classList.remove('hidden');
    } else {
      proveedorFields.classList.add('hidden');
    }
  }

  rolSelect.addEventListener('change', toggleProveedorFields);
  document.addEventListener('DOMContentLoaded', toggleProveedorFields);
</script>
{% endblock %}
