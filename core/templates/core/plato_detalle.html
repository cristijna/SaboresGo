{% extends "core/base.html" %}
{% load static %}
{% load core_filters %}

{% block content %}

<div class="container mt-4">
    <div class="card shadow-sm p-4">

        <div class="row">
            <!-- Imagen -->
            <div class="col-md-5 text-center">
                {% if plato.imagen %}
                    <img src="{{ plato.imagen.url }}" class="img-fluid rounded" style="max-height: 320px;">
                {% else %}
                    <img src="{% static 'img/no-image.png' %}" class="img-fluid rounded">
                {% endif %}
            </div>

            <!-- Información -->
            <div class="col-md-7">
                <h2 class="fw-bold">{{ plato.nombre }}</h2>

                <p class="text-muted">{{ plato.descripcion }}</p>

                {% if plato.ingredientes %}
                    <h5 class="mt-3 fw-bold">Ingredientes</h5>
                    <ul class="ps-3">
                        {% for ing in plato.ingredientes|split:"," %}
                            <li>{{ ing }}</li>
                        {% endfor %}
                    </ul>
                {% endif %}

                <h4 class="mt-4">
                    <span class="badge bg-success p-2 fs-5">
                        ${{ plato.precio }}
                    </span>
                </h4>

                <hr>

                <!-- Pedido rápido -->
                {% if user.is_authenticated %}
                <form method="post" action="{% url 'core:pedido_rapido' plato.id %}">
                    {% csrf_token %}

                    <label class="fw-semibold">Cantidad</label>
                    <div class="d-flex align-items-center mb-3" style="gap: 12px;">
                        <button type="button" class="btn btn-outline-dark" id="btn-menos">−</button>
                        <input type="number" name="cantidad" id="cantidad"
                               class="form-control text-center"
                               style="width: 70px;" value="1" min="1">
                        <button type="button" class="btn btn-dark" id="btn-mas">+</button>
                    </div>

                    <button type="submit" class="btn btn-primary w-100 py-2">
                        Añadir al carrito
                    </button>
                </form>
                {% else %}
                <div class="alert alert-info mt-4">
                    Inicia sesión para realizar pedidos.
                </div>
                {% endif %}
            </div>
        </div>

    </div>
</div>

<script>
    const cant = document.getElementById('cantidad');
    document.getElementById('btn-mas').onclick = () => cant.value++;
    document.getElementById('btn-menos').onclick = () => {
        if (cant.value > 1) cant.value--;
    };
</script>

{% endblock %}
