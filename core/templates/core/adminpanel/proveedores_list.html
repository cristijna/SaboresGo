{% extends "core/base.html" %}
{% block title %}Proveedores{% endblock %}

{% block extra_css %}
<style>
  .admin-table {
    width: 100%;
    border-collapse: collapse;
    background: #ffffff;
    border-radius: 16px;
    overflow: hidden;
    box-shadow: 0 4px 12px rgba(0,0,0,0.06);
    margin-top: 20px;
  }

  .admin-table th,
  .admin-table td {
    padding: 14px 16px;
    border-bottom: 1px solid #e5e7eb;
    font-size: 0.92rem;
  }

  .admin-table th {
    background: #f9fafb;
    text-align: left;
    font-weight: 600;
    color: #374151;
  }

  .admin-table tr:hover td {
    background: #f3f4f6;
  }

  .badge {
    padding: 6px 10px;
    font-size: 0.78rem;
    font-weight: 600;
    border-radius: 8px;
    display: inline-block;
  }

  .badge-green {
    background: #dcfce7;
    color: #166534;
  }

  .badge-orange {
    background: #ffedd5;
    color: #c2410c;
  }

  .btn-small {
    padding: 6px 10px;
    border-radius: 6px;
    font-size: 0.78rem;
    font-weight: 600;
    text-decoration: none;
    color: white;
  }

  .btn-approve { background: #16a34a; }
  .btn-reject { background: #ea580c; }

  h1 {
    margin-bottom: 20px;
  }
</style>
{% endblock %}

{% block content %}
<h1>Proveedores</h1>

<table class="admin-table">
  <thead>
    <tr>
      <th>Usuario</th>
      <th>Empresa</th>
      <th>Pedidos recibidos</th>
      <th>Ingresos generados</th>
      <th>Platos publicados</th>
      <th>Estado</th>
      <th></th>
    </tr>
  </thead>

  <tbody>
    {% for p in proveedores %}
    <tr>
      <td>{{ p.proveedor.user.username }}</td>
      <td>{{ p.proveedor.empresa }}</td>
      <td>{{ p.total_pedidos }}</td>
      <td>${{ p.total_ingresos|floatformat:0 }}</td>
      <td>{{ p.platos_count }}</td>

      <td>
        {% if p.proveedor.aprobado %}
          <span class="badge badge-green">Aprobado</span>
        {% else %}
          <span class="badge badge-orange">Pendiente</span>
        {% endif %}
      </td>

      <td style="white-space:nowrap;">

        <!-- Botones aprobar / rechazar -->
        {% if not p.proveedor.aprobado %}
          <a href="{% url 'adminpanel:aprobar_proveedor' p.proveedor.id %}"
             class="btn-small btn-approve">
            Aprobar
          </a>
        {% else %}
          <a href="{% url 'adminpanel:rechazar_proveedor' p.proveedor.id %}"
             class="btn-small btn-reject">
            Rechazar
          </a>
        {% endif %}

        <!-- Botón ver detalle -->
        <a href="{% url 'adminpanel:proveedor_detalle' p.proveedor.id %}"
           style="color:#2563eb; font-weight:600; margin-left:10px;">
          Ver detalle →
        </a>
      </td>
    </tr>
    {% empty %}
      <tr>
        <td colspan="7" style="text-align:center; padding:16px;">No hay proveedores registrados.</td>
      </tr>
    {% endfor %}
  </tbody>
</table>

{% endblock %}
